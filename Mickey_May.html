<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mickey May's Whiskey Dance-Off</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            padding: 20px;
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #2b2b2b;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 500px;
            border: 2px solid #3d3d3d;
        }
        canvas {
            background-color: #444;
            border-radius: 8px;
            border: 2px solid #555;
            margin-bottom: 20px;
        }
        .controls {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            margin-bottom: 16px;
        }
        .movement-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 400px;
            margin-top: 16px;
        }
        .button, .move-button {
            padding: 12px 24px;
            background-color: #4a90e2;
            color: white;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            flex-grow: 1;
            margin: 0 5px;
        }
        .button:hover, .move-button:hover {
            background-color: #357bd8;
        }
        .button:active, .move-button:active {
            transform: scale(0.98);
        }
        h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 12px;
            color: #d89614;
        }
        h2 {
            font-size: 1.5rem;
            margin-bottom: 16px;
            color: #e0e0e0;
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #1a1a1a;
            border: 2px solid #d89614;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            font-size: 1.2rem;
            color: white;
            display: none;
        }
        .message-box-button {
            margin-top: 15px;
            background-color: #4a90e2;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="game-container">
    <h1>Mickey May's Whiskey Dance-Off</h1>
    <h2>Score: <span id="score">0</span> / 10</h2>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div class="controls">
        <div id="danceButton" class="button">Dance</div>
    </div>
    <div class="movement-controls">
        <div id="moveLeftButton" class="move-button">&larr;</div>
        <div id="moveRightButton" class="move-button">&rarr;</div>
    </div>
</div>

<div id="messageBox" class="message-box">
    <p id="messageText"></p>
    <button id="messageBoxButton" class="message-box-button">OK</button>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreElement = document.getElementById('score');
    const danceButton = document.getElementById('danceButton');
    const messageBox = document.getElementById('messageBox');
    const messageText = document.getElementById('messageText');
    const messageBoxButton = document.getElementById('messageBoxButton');
    const moveLeftButton = document.getElementById('moveLeftButton');
    const moveRightButton = document.getElementById('moveRightButton');

    // --- Game State Variables ---
    let score = 0;
    let isDancing = false;
    let isDrinking = false;
    let isWinning = false;
    let drinkAnimationFrame = 0;
    let danceAnimationFrame = 0;
    let winAnimationFrame = 0;
    let isGameOver = false;

    const man = { 
        x: canvas.width / 2, 
        y: canvas.height - 100, 
        width: 20, 
        height: 60,
        dx: 0, 
        speed: 5
    };
    const whiskey = { x: 0, y: 0, width: 15, height: 30, isVisible: false };
    let whiskeyFallSpeed = 3;
    let whiskeySpawnInterval = 2000;
    let whiskeyIntervalId = null;

    // --- Drawing Functions ---
    function drawMan() {
        ctx.fillStyle = '#f0f0f0';
        // Head
        ctx.beginPath();
        ctx.arc(man.x, man.y - 20, 10, 0, Math.PI * 2, false);
        ctx.fill();
        // Body
        ctx.fillRect(man.x - man.width / 2, man.y - 10, man.width, man.height);
        // Arms (default position)
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2, man.y);
        ctx.lineTo(man.x - man.width / 2 - 15, man.y + 15);
        ctx.moveTo(man.x + man.width / 2, man.y);
        ctx.lineTo(man.x + man.width / 2 + 15, man.y + 15);
        ctx.strokeStyle = '#f0f0f0';
        ctx.lineWidth = 3;
        ctx.stroke();
        // Legs
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2 + 5, man.y + man.height);
        ctx.lineTo(man.x - man.width / 2 + 5, man.y + man.height + 20);
        ctx.moveTo(man.x + man.width / 2 - 5, man.y + man.height);
        ctx.lineTo(man.x + man.width / 2 - 5, man.y + man.height + 20);
        ctx.stroke();
    }

    function drawDancingMan() {
        ctx.fillStyle = '#f0f0f0';
        // Head
        ctx.beginPath();
        ctx.arc(man.x, man.y - 20, 10, 0, Math.PI * 2, false);
        ctx.fill();
        // Body (swaying)
        const sway = Math.sin(danceAnimationFrame * 0.2) * 2;
        ctx.fillRect(man.x - man.width / 2 + sway, man.y - 10, man.width, man.height);
        // Arms (swaying)
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2 + sway, man.y);
        ctx.lineTo(man.x - man.width / 2 - 15 + sway, man.y + 15);
        ctx.moveTo(man.x + man.width / 2 + sway, man.y);
        ctx.lineTo(man.x + man.width / 2 + 15 + sway, man.y + 15);
        ctx.strokeStyle = '#f0f0f0';
        ctx.lineWidth = 3;
        ctx.stroke();
        // Legs (kicking)
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2 + 5 + sway, man.y + man.height);
        const legKick = Math.sin(danceAnimationFrame * 0.4) * 10;
        ctx.lineTo(man.x - man.width / 2 + 5 + sway - legKick, man.y + man.height + 20);
        ctx.moveTo(man.x + man.width / 2 - 5 + sway, man.y + man.height);
        ctx.lineTo(man.x + man.width / 2 - 5 + sway + legKick, man.y + man.height + 20);
        ctx.stroke();
    }

    function drawDrinkingMan() {
        ctx.fillStyle = '#f0f0f0';
        // Head
        ctx.beginPath();
        ctx.arc(man.x, man.y - 20, 10, 0, Math.PI * 2, false);
        ctx.fill();
        // Body
        ctx.fillRect(man.x - man.width / 2, man.y - 10, man.width, man.height);
        
        // Arms (drinking animation)
        const armUp = Math.min(drinkAnimationFrame * 5, 20);
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2, man.y);
        ctx.lineTo(man.x - man.width / 2 - 15, man.y + 15);
        ctx.moveTo(man.x + man.width / 2, man.y);
        ctx.lineTo(man.x + man.width / 2 + 15, man.y + 15 - armUp);
        ctx.strokeStyle = '#f0f0f0';
        ctx.lineWidth = 3;
        ctx.stroke();
        
        // Draw small bottle in hand
        ctx.fillStyle = '#6B4423';
        const bottleX = man.x + man.width / 2 + 15;
        const bottleY = man.y + 15 - armUp;
        // Draw bottle body
        ctx.fillRect(bottleX - 5, bottleY - 15, 10, 15);
        // Draw bottle top/neck
        ctx.fillRect(bottleX - 2, bottleY - 20, 4, 5);

        // Legs
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2 + 5, man.y + man.height);
        ctx.lineTo(man.x - man.width / 2 + 5, man.y + man.height + 20);
        ctx.moveTo(man.x + man.width / 2 - 5, man.y + man.height);
        ctx.lineTo(man.x + man.width / 2 - 5, man.y + man.height + 20);
        ctx.stroke();
    }
    
    function drawWinningMan() {
        ctx.fillStyle = '#f0f0f0';
        // Head
        ctx.beginPath();
        ctx.arc(man.x, man.y - 20, 10, 0, Math.PI * 2, false);
        ctx.fill();
        // Body
        ctx.fillRect(man.x - man.width / 2, man.y - 10, man.width, man.height);
        
        // Arms (dramatic drinking animation)
        const armUp = Math.sin(winAnimationFrame * 0.1) * 20 + 20;
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2, man.y);
        ctx.lineTo(man.x - man.width / 2 - 15, man.y + 15);
        ctx.moveTo(man.x + man.width / 2, man.y);
        ctx.lineTo(man.x + man.width / 2 + 15, man.y + 15 - armUp);
        ctx.strokeStyle = '#f0f0f0';
        ctx.lineWidth = 3;
        ctx.stroke();
        
        // Draw small bottle in hand
        ctx.fillStyle = '#6B4423';
        const bottleX = man.x + man.width / 2 + 15;
        const bottleY = man.y + 15 - armUp;
        // Draw bottle body
        ctx.fillRect(bottleX - 5, bottleY - 15, 10, 15);
        // Draw bottle top/neck
        ctx.fillRect(bottleX - 2, bottleY - 20, 4, 5);

        // Legs
        ctx.beginPath();
        ctx.moveTo(man.x - man.width / 2 + 5, man.y + man.height);
        ctx.lineTo(man.x - man.width / 2 + 5, man.y + man.height + 20);
        ctx.moveTo(man.x + man.width / 2 - 5, man.y + man.height);
        ctx.lineTo(man.x + man.width / 2 - 5, man.y + man.height + 20);
        ctx.stroke();
    }
    
    function drawWhiskey() {
        if (whiskey.isVisible) {
            ctx.fillStyle = '#6B4423';
            // Draw bottle body
            ctx.fillRect(whiskey.x, whiskey.y + 5, whiskey.width, whiskey.height - 5);
            // Draw bottle top/neck
            ctx.fillRect(whiskey.x + whiskey.width / 2 - 2, whiskey.y, 4, 5);

            // Draw label
            ctx.fillStyle = '#4a2c1a'; // A slightly darker brown for the label
            ctx.fillRect(whiskey.x + 2, whiskey.y + 10, whiskey.width - 4, 8);
        }
    }

    // --- Game Logic ---
    function updateScore(points) {
        score += points;
        scoreElement.textContent = score;

        if (score >= 10) {
            isWinning = true;
            clearInterval(whiskeyIntervalId);
            man.dx = 0;
            // Show the win message after a small delay to let the animation play
            setTimeout(() => {
                isGameOver = true;
                showMessage("Congratulations! You win... IT is already here...");
            }, 1000);
        }
    }

    function spawnWhiskey() {
        if (isGameOver || isWinning) return;
        whiskey.x = Math.random() * (canvas.width - whiskey.width);
        whiskey.y = -whiskey.height;
        whiskey.isVisible = true;
    }

    function showMessage(text) {
        messageText.textContent = text;
        messageBox.style.display = 'block';
    }

    function hideMessage() {
        messageBox.style.display = 'none';
        if (isGameOver) {
            resetGame();
        }
    }

    function resetGame() {
        score = 0;
        scoreElement.textContent = score;
        isGameOver = false;
        isWinning = false;
        whiskeyFallSpeed = 3;
        whiskeySpawnInterval = 2000;
        isDrinking = false;
        
        // Restart the whiskey spawning
        clearInterval(whiskeyIntervalId);
        whiskeyIntervalId = setInterval(spawnWhiskey, whiskeySpawnInterval);
    }

    // --- Main Game Loop ---
    function gameLoop() {
        if (isGameOver) {
            // If the game is won, only draw the winning animation
            drawWinningMan();
            winAnimationFrame++;
            requestAnimationFrame(gameLoop);
            return;
        }

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Update man's position based on movement controls
        man.x += man.dx;
        
        // Keep the man within the canvas boundaries
        if (man.x < man.width / 2) {
            man.x = man.width / 2;
        }
        if (man.x > canvas.width - man.width / 2) {
            man.x = canvas.width - man.width / 2;
        }

        // Update whiskey position
        if (whiskey.isVisible) {
            whiskey.y += whiskeyFallSpeed;
            if (whiskey.y > canvas.height) {
                whiskey.isVisible = false;
            }
        }
        
        // Collision detection for collecting whiskey
        if (whiskey.isVisible) {
            const manRect = { x: man.x - man.width / 2, y: man.y - 10, width: man.width, height: man.height + 20 };
            const whiskeyRect = { x: whiskey.x, y: whiskey.y, width: whiskey.width, height: whiskey.height };

            if (manRect.x < whiskeyRect.x + whiskeyRect.width &&
                manRect.x + manRect.width > whiskeyRect.x &&
                manRect.y < whiskeyRect.y + whiskeyRect.height &&
                manRect.y + manRect.height > whiskeyRect.y) {
                
                updateScore(1);
                whiskey.isVisible = false;
                
                // Increase difficulty
                if (whiskeyFallSpeed < 10) {
                    whiskeyFallSpeed += 0.5;
                }

                // Trigger drinking animation
                isDrinking = true;
                drinkAnimationFrame = 0;
                setTimeout(() => {
                    isDrinking = false;
                }, 500); 
            }
        }

        if (isDancing) {
            drawDancingMan();
            danceAnimationFrame++;
        } else if (isDrinking) {
            drawDrinkingMan();
            drinkAnimationFrame++;
        } else {
            drawMan();
        }

        drawWhiskey();
        
        requestAnimationFrame(gameLoop);
    }

    // --- Event Listeners ---
    danceButton.addEventListener('click', () => {
        isDancing = !isDancing;
        if (isDancing) {
            danceButton.textContent = "Stop Dancing";
            danceAnimationFrame = 0;
        } else {
            danceButton.textContent = "Dance";
        }
    });

    messageBoxButton.addEventListener('click', hideMessage);
    
    // Touch and click listeners for mobile controls
    moveLeftButton.addEventListener('mousedown', () => man.dx = -man.speed);
    moveLeftButton.addEventListener('mouseup', () => man.dx = 0);
    moveLeftButton.addEventListener('touchstart', (e) => {
        e.preventDefault();
        man.dx = -man.speed;
    });
    moveLeftButton.addEventListener('touchend', () => man.dx = 0);

    moveRightButton.addEventListener('mousedown', () => man.dx = man.speed);
    moveRightButton.addEventListener('mouseup', () => man.dx = 0);
    moveRightButton.addEventListener('touchstart', (e) => {
        e.preventDefault();
        man.dx = man.speed;
    });
    moveRightButton.addEventListener('touchend', () => man.dx = 0);

    // Initial setup
    function init() {
        console.log("Game successfully loaded and running.");
        whiskeyIntervalId = setInterval(spawnWhiskey, whiskeySpawnInterval);
        gameLoop();
    }
    init();
</script>

</body>
</html>

